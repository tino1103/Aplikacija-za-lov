{"ast":null,"code":"var _jsxFileName = \"/Users/valentinodenona/Desktop/REACT/Aplikacija-za-lov/src/withAdminProtection2.js\";\nimport React, { useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode'; // Ispravno uvođenje jwtDecode\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction withAdminProtection(Component) {\n  var _s = $RefreshSig$();\n  return _s(function ProtectedComponent(props) {\n    _s();\n    const navigate = useNavigate();\n    const alertShownRef = useRef(false); // Koristimo useRef za praćenje stanja prikazivanja upozorenja\n    const token = localStorage.getItem('token');\n    let role = null;\n    if (token) {\n      try {\n        const decoded = jwtDecode(token);\n        role = decoded.uloga; // Pretpostavljam da 'uloga' postoji u JWT payloadu\n      } catch (error) {\n        console.error('Error decoding token:', error);\n      }\n    }\n    useEffect(() => {\n      if (!token || role !== 'admin') {\n        if (!alertShownRef.current) {\n          alertShownRef.current = true; // Postavljamo referencu na true\n          alert('Niste autorizirani za pristup ovoj stranici. Samo administratori mogu pristupiti.');\n          navigate('/glavni-izbornik', {\n            replace: true\n          });\n        }\n      }\n    }, [navigate, token, role]); // Uklonili smo alertShown iz ovisnosti\n\n    if (!token || role !== 'korisnik') {\n      return null; // Vraća null ako korisnik nije admin ili ako token nije prisutan\n    }\n    return /*#__PURE__*/_jsxDEV(Component, {\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 16\n    }, this);\n  }, \"INYU98bGmgjlXYCgbOlEyiLm+fw=\", false, function () {\n    return [useNavigate];\n  });\n}\nexport default withAdminProtection;","map":{"version":3,"names":["React","useEffect","useRef","useNavigate","jwtDecode","jsxDEV","_jsxDEV","withAdminProtection","Component","_s","$RefreshSig$","ProtectedComponent","props","navigate","alertShownRef","token","localStorage","getItem","role","decoded","uloga","error","console","current","alert","replace","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/valentinodenona/Desktop/REACT/Aplikacija-za-lov/src/withAdminProtection2.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode'; // Ispravno uvođenje jwtDecode\n\nfunction withAdminProtection(Component) {\n    return function ProtectedComponent(props) {\n        const navigate = useNavigate();\n        const alertShownRef = useRef(false); // Koristimo useRef za praćenje stanja prikazivanja upozorenja\n        const token = localStorage.getItem('token');\n        let role = null;\n\n        if (token) {\n            try {\n                const decoded = jwtDecode(token);\n                role = decoded.uloga; // Pretpostavljam da 'uloga' postoji u JWT payloadu\n            } catch (error) {\n                console.error('Error decoding token:', error);\n            }\n        }\n\n        useEffect(() => {\n            if (!token || role !== 'admin') {\n                if (!alertShownRef.current) {\n                    alertShownRef.current = true; // Postavljamo referencu na true\n                    alert('Niste autorizirani za pristup ovoj stranici. Samo administratori mogu pristupiti.');\n                    navigate('/glavni-izbornik', { replace: true });\n                }\n            }\n        }, [navigate, token, role]); // Uklonili smo alertShown iz ovisnosti\n\n        if (!token || role !== 'korisnik') {\n            return null; // Vraća null ako korisnik nije admin ili ako token nije prisutan\n        }\n\n        return <Component {...props} />;\n    };\n}\n\nexport default withAdminProtection;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAChD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,SAAS,QAAQ,YAAY,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAExC,SAASC,mBAAmBA,CAACC,SAAS,EAAE;EAAA,IAAAC,EAAA,GAAAC,YAAA;EACpC,OAAAD,EAAA,CAAO,SAASE,kBAAkBA,CAACC,KAAK,EAAE;IAAAH,EAAA;IACtC,MAAMI,QAAQ,GAAGV,WAAW,CAAC,CAAC;IAC9B,MAAMW,aAAa,GAAGZ,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IACrC,MAAMa,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAIC,IAAI,GAAG,IAAI;IAEf,IAAIH,KAAK,EAAE;MACP,IAAI;QACA,MAAMI,OAAO,GAAGf,SAAS,CAACW,KAAK,CAAC;QAChCG,IAAI,GAAGC,OAAO,CAACC,KAAK,CAAC,CAAC;MAC1B,CAAC,CAAC,OAAOC,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MACjD;IACJ;IAEApB,SAAS,CAAC,MAAM;MACZ,IAAI,CAACc,KAAK,IAAIG,IAAI,KAAK,OAAO,EAAE;QAC5B,IAAI,CAACJ,aAAa,CAACS,OAAO,EAAE;UACxBT,aAAa,CAACS,OAAO,GAAG,IAAI,CAAC,CAAC;UAC9BC,KAAK,CAAC,mFAAmF,CAAC;UAC1FX,QAAQ,CAAC,kBAAkB,EAAE;YAAEY,OAAO,EAAE;UAAK,CAAC,CAAC;QACnD;MACJ;IACJ,CAAC,EAAE,CAACZ,QAAQ,EAAEE,KAAK,EAAEG,IAAI,CAAC,CAAC,CAAC,CAAC;;IAE7B,IAAI,CAACH,KAAK,IAAIG,IAAI,KAAK,UAAU,EAAE;MAC/B,OAAO,IAAI,CAAC,CAAC;IACjB;IAEA,oBAAOZ,OAAA,CAACE,SAAS;MAAA,GAAKI;IAAK;MAAAc,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EACnC,CAAC;IAAA,QA7BoB1B,WAAW;EAAA;AA8BpC;AAEA,eAAeI,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}